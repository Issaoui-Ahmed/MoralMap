"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[485],{1485:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var r=s(5155),a=s(2115);let l=()=>{let e=localStorage.getItem("sessionId"),[t,s]=(0,a.useState)(null),[l,n]=(0,a.useState)({}),[o,i]=(0,a.useState)(!1),[u,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{fetch("http://localhost:5000/api/route-endpoints").then(e=>e.json()).then(e=>{s(e);let t={};(e.survey||[]).forEach(e=>{t[e.name]=""}),n(t)}).catch(e=>{console.error("Failed to load survey config:",e),c("Failed to load survey questions.")})},[]);let d=(e,t)=>{n(s=>({...s,[e]:t}))},m=async()=>{c(null);try{let t=await fetch("http://localhost:5000/api/log-survey",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,responses:l})}),s=await t.text(),r=(()=>{try{return JSON.parse(s)}catch(e){return{}}})();if(!t.ok||!(null==r?void 0:r.success))throw Error((null==r?void 0:r.error)||"Submission failed");i(!0)}catch(e){c(e.message||"Could not submit survey. Please try again.")}};return o?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 p-4",children:(0,r.jsx)("p",{className:"text-2xl font-semibold text-gray-800",children:"Thank you for your feedback!"})}):t?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 p-4",children:(0,r.jsxs)("div",{className:"w-full max-w-lg rounded-lg bg-white p-8 shadow-lg",children:[(t.survey||[]).map(e=>(0,r.jsxs)("div",{className:"mb-5",children:[(0,r.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:e.name}),"select"===e.type?(0,r.jsxs)("select",{value:l[e.name]||"",onChange:t=>d(e.name,t.target.value),className:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Select an option"}),(e.options||[]).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}):(0,r.jsx)("input",{type:e.type,value:l[e.name]||"",onChange:t=>d(e.name,t.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]},e.name)),(0,r.jsx)("button",{onClick:m,className:"w-full rounded-md bg-blue-600 px-4 py-2 font-semibold text-white shadow transition-colors hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Submit"}),u&&(0,r.jsx)("p",{className:"mt-4 text-center text-sm text-red-600",children:u})]})}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 p-4",children:(0,r.jsx)("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"})})}}}]);